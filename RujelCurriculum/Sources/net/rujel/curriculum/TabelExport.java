package net.rujel.curriculum;

import com.webobjects.appserver.*;
import com.webobjects.foundation.NSDictionary;

// Generated by the WOLips Templateengine Plug-in at May 13, 2009 4:09:09 PM
public class TabelExport extends com.webobjects.appserver.WOComponent {
    public TabelExport(WOContext context) {
        super(context);
    }
    
    public NSDictionary monthDict; 
    
	public void appendToResponse(WOResponse aResponse, WOContext aContext) {
		aResponse.appendContentString(monthDict.toString());
		
    	aResponse.setHeader("application/octet-stream","Content-Type");
    	StringBuffer buf = new StringBuffer("attachment; filename=\"tabel");
    	buf.append(monthDict.valueForKey("year"));//.append('-');
    	int month = ((Integer)monthDict.valueForKey("month")).intValue();
    	month++;
    	if(month < 10)
    		buf.append('0');
    	buf.append(month);
		buf.append(".csv\"");
		aResponse.setHeader(buf.toString(),"Content-Disposition");
	}
	
	public boolean isStateless() {
		return true;
	}
}